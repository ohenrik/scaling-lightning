"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1207],{3905:(e,n,t)=>{t.d(n,{Zo:()=>g,kt:()=>f});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=r.createContext({}),c=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},g=function(e){var n=c(e.components);return r.createElement(s.Provider,{value:n},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,g=l(e,["components","mdxType","originalType","parentName"]),u=c(t),m=o,f=u["".concat(s,".").concat(m)]||u[m]||p[m]||a;return t?r.createElement(f,i(i({ref:n},g),{},{components:t})):r.createElement(f,i({ref:n},g))}));function f(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=m;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var c=2;c<a;c++)i[c]=t[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},7480:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var r=t(7462),o=(t(7294),t(3905));const a={sidebar_position:6},i="Golang API",l={unversionedId:"api",id:"api",title:"Golang API",description:"As an alternative to the CLI, a golang library is available with all the same functions. In the future we aim to release libraries for other programming languages. Please get in touch to request which language we should work on next.",source:"@site/docs/api.md",sourceDirName:".",slug:"/api",permalink:"/docs/api",draft:!1,editUrl:"https://github.com/scaling-lightning/scaling-lightning/tree/main/docs/docs/api.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"docsSidebar",previous:{title:"CLI",permalink:"/docs/cli"},next:{title:"Specify initial state",permalink:"/docs/initial-state"}},s={},c=[{value:"Installation",id:"installation",level:2},{value:"Example Golang test",id:"example-golang-test",level:2}],g={toc:c},u="wrapper";function p(e){let{components:n,...t}=e;return(0,o.kt)(u,(0,r.Z)({},g,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"golang-api"},"Golang API"),(0,o.kt)("p",null,"As an alternative to the CLI, a golang library is available with all the same functions. In the future we aim to release libraries for other programming languages. Please get in touch to request which language we should work on next."),(0,o.kt)("h2",{id:"installation"},"Installation"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"go get github.com/scaling-lightning/scaling-lightning\n")),(0,o.kt)("h2",{id:"example-golang-test"},"Example Golang test"),(0,o.kt)("p",null,"Before running this test, ensure the prerequisits are installed on the local system and kubernetes cluster. Please see the ",(0,o.kt)("a",{parentName:"p",href:"/docs/getting-started"},"Getting Started")," guide."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport (\n    "testing"\n\n    "github.com/rs/zerolog"\n    "github.com/rs/zerolog/log"\n    "github.com/scaling-lightning/scaling-lightning/pkg/initialstate"\n    sl "github.com/scaling-lightning/scaling-lightning/pkg/network"\n    "github.com/stretchr/testify/assert"\n)\n\n// will need a longish (few mins) timeout\nfunc TestMainExample(t *testing.T) {\n    zerolog.SetGlobalLevel(zerolog.DebugLevel)\n    assert := assert.New(t)\n    network := sl.NewSLNetwork("../helmfiles/public.yaml", "", sl.Regtest)\n    err := network.CreateAndStart()\n    if err != nil {\n        log.Fatal().Err(err).Msg("Problem starting network")\n    }\n\n    const initialStateYAML = `\n- SendOnChain:\n    - { from: bitcoind, to: cln1, amountSats: 1_000_000 }\n- ConnectPeer:\n    - { from: cln1, to: cln2 }\n- OpenChannels:\n    - { from: cln1, to: cln2, localAmountSats: 200_000 }\n    - { from: cln1, to: cln2, localAmountSats: 300_000 }\n- SendOverChannel:\n    - { from: cln1, to: cln2, amountMSat: 2_000_000 }\n`\n    initialState, err := initialstate.NewInitialStateFromBytes([]byte(initialStateYAML), &network)\n    assert.NoError(err)\n    err = initialState.Apply()\n    assert.NoError(err)\n\n    cln2, err := network.GetLightningNode("cln2")\n    assert.NoError(err)\n\n    assert.NoError(err)\n    defer func() {\n        err = network.Destroy()\n        assert.NoError(err)\n    }()\n\n    balance, err := network.GetWalletBalance("cln1")\n    assert.NoError(err)\n    log.Info().Msgf("cln1 balance: %d", balance.AsSats())\n\n    connectionDetails, err := network.GetConnectionDetails("cln2")\n    assert.NoError(err)\n    log.Info().Msgf("cln2 connection host: %v", connectionDetails[0].Host)\n    log.Info().Msgf("cln2 connection host: %d", connectionDetails[0].Port)\n\n    connectionFiles, err := cln2.GetConnectionFiles(network.Network.String(), "")\n    assert.NoError(err)\n    log.Info().Msgf("cln2 client cert size : %v", len(connectionFiles.CLN.ClientCert))\n}\n')))}p.isMDXComponent=!0}}]);